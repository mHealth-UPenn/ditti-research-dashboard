{
	"Parameters": {
		"UserPoolName": {
			"Type": "String",
			"Default": "AccountPool-dev-rev2",
			"Description": "Name of the Cognito User Pool"
		},
		"AppName": {
			"Type": "String",
			"Default": "ResearcherApp-dev-rev2",
			"Description": "Name of the Cognito User Pool"
		},
		"CallbackURL": {
			"Type": "String",
			"Default": "http://localhost:5000/auth/researcher/callback",
			"Description": "URL to redirect to after authentication"
		},
		"LogoutURL": {
			"Type": "String",
			"Default": "http://localhost:3000/coordinator/login",
			"Description": "URL to redirect to after logout"
		},
		"DomainPrefix": {
			"Type": "String",
			"Default": "penn-ditti-researcher-dev-rev2",
			"Description": "Prefix for the Cognito Domain"
		}
	},
	"Resources": {
		"UserPoolDomain": {
			"Type": "AWS::Cognito::UserPoolDomain",
			"Properties": {
				"UserPoolId": {
					"Ref": "CognitoUserPoolLogicalID"
				},
				"Domain": {
					"Fn::Sub": "https://${DomainPrefix}.auth.${AWS::Region}.amazoncognito.com"
				}
			}
		},
		"CognitoUserPoolLogicalID": {
			"Type": "AWS::Cognito::UserPool",
			"Properties": {
				"UserPoolName": {
					"Ref": "UserPoolName"
				},
				"AutoVerifiedAttributes": [
					"email"
				],
				"UsernameAttributes": [
					"email"
				],
				"EmailConfiguration": {
					"EmailSendingAccount": "COGNITO_DEFAULT"
				},
				"AdminCreateUserConfig": {
					"AllowAdminCreateUserOnly": true
				},
				"Schema": [
					{
						"Name": "email",
						"AttributeDataType": "String",
						"Mutable": false,
						"Required": true
					},
					{
						"Name": "phone_number",
						"AttributeDataType": "String",
						"Mutable": true,
						"Required": false
					},
					{
						"Name": "given_name",
						"AttributeDataType": "String",
						"Mutable": true,
						"Required": true
					},
					{
						"Name": "family_name",
						"AttributeDataType": "String",
						"Mutable": true,
						"Required": true
					}
				]
			}
		},
		"CognitoUserPoolClientLogicalID": {
			"Type": "AWS::Cognito::UserPoolClient",
			"Properties": {
				"UserPoolId": {
					"Ref": "CognitoUserPoolLogicalID"
				},
				"ClientName": {
					"Ref": "AppName"
				},
				"GenerateSecret": true,
				"ExplicitAuthFlows": [
					"ALLOW_USER_PASSWORD_AUTH",
					"ALLOW_REFRESH_TOKEN_AUTH"
				],
				"SupportedIdentityProviders": [
					"COGNITO"
				],
				"CallbackURLs": [
					{
						"Ref": "CallbackURL"
					}
				],
				"LogoutURLs": [
					{
						"Ref": "LogoutURL"
					}
				],
				"AllowedOAuthFlows": [
					"code"
				],
				"AllowedOAuthScopes": [
					"openid",
					"email",
					"phone",
					"profile"
				],
				"AllowedOAuthFlowsUserPoolClient": true
			}
		}
	}
}